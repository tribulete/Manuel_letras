<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Canci√≥n</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1 id="titulo"></h1>
  <div id="contenido"></div>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    const params = new URLSearchParams(window.location.search);
    const fichero = params.get("fichero");
    const duracion = parseInt(params.get("duracion") || "120", 10); // en segundos

    document.getElementById("titulo").textContent = fichero.replace(/_/g, ' ').replace('.md', '');

    async function cargarLetra() {
      const response = await fetch(fichero);
      const markdown = await response.text();
      const html = marked.parse(markdown);
      const contenedor = document.getElementById("contenido");
      contenedor.innerHTML = html;

      // Auto scroll
      const totalHeight = contenedor.scrollHeight - window.innerHeight;
      const intervalo = 20; // ms
      const pasos = (duracion * 1000) / intervalo;
      const incremento = totalHeight / pasos;

      let scroll = 0;
      const scrollInterval = setInterval(() => {
        scroll += incremento;
        window.scrollTo({ top: scroll, behavior: "smooth" });
        if (scroll >= totalHeight) clearInterval(scrollInterval);
      }, intervalo);
    }

    cargarLetra();
  </script>
</body>
</html>
